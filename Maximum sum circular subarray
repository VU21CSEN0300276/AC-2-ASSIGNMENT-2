#include <limits.h>

int maxSubarraySumCircular(int* nums, int numsSize) {
    int maxSum = INT_MIN;  
    int minSum = INT_MAX;  
    int totalSum = 0;      
    int currentMax = 0;    
    int currentMin = 0;    

    for (int i = 0; i < numsSize; i++) {
        totalSum += nums[i];
        currentMax = (currentMax > 0 ? currentMax : 0) + nums[i];
        maxSum = currentMax > maxSum ? currentMax : maxSum;
        currentMin = (currentMin < 0 ? currentMin : 0) + nums[i];
        minSum = currentMin < minSum ? currentMin : minSum;
    }
    if (maxSum < 0) {
        return maxSum;
    }
    return maxSum > (totalSum - minSum) ? maxSum : (totalSum - minSum);
}
